new 統計及排序各種類 遊戲平均評分(+user_rating)
 
select "Abstract Strategy" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Abstract Strategy%' group by board_category)as a union
select "Action / Dexterity" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Action / Dexterity%' group by board_category)as a union
select "Adventure" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Adventure%' group by board_category)as a union
select "Age of Reason" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Age of Reason%' group by board_category)as a union
select "American Civil War" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%American Civil War%' group by board_category)as a union
select "American Indian Wars" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%American Indian Wars%' group by board_category)as a union
select "American Revolutionary War" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%American Revolutionary War%' group by board_category)as a union
select "American West" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%American West%' group by board_category)as a union
select "Ancient" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Ancient%' group by board_category)as a union
select "Animals" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Animals%' group by board_category)as a union
select "Arabian" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Arabian%' group by board_category)as a union
select "Aviation / Flight" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Aviation / Flight%' group by board_category)as a union
select "Bluffing" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Bluffing%' group by board_category)as a union
select "Book" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Book%' group by board_category)as a union
select "Card Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Card Game%' group by board_category)as a union
select "Children's Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like "%Children's Game%" group by board_category)as a union
select "City Building" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%City Building%' group by board_category)as a union
select "Civil War" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Civil War%' group by board_category)as a union
select "Civilization" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Civilization%' group by board_category)as a union
select "Collectible Components" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Collectible Components%' group by board_category)as a union
select "Comic Book / Strip" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Comic Book / Strip%' group by board_category)as a union
select "Deduction" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Deduction%' group by board_category)as a union
select "Dice" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Dice%' group by board_category)as a union
select "Economic" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Economic%' group by board_category)as a union
select "Educational" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Educational%' group by board_category)as a union
select "Electronic" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Electronic%' group by board_category)as a union
select "Environmental" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Environmental%' group by board_category)as a union
select "Expansion for Base-game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Expansion for Base-game%' group by board_category)as a union
select "Exploration" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Exploration%' group by board_category)as a union
select "Fan Expansion" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Fan Expansion%' group by board_category)as a union
select "Fantasy" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Fantasy%' group by board_category)as a union
select "Farming" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Farming%' group by board_category)as a union
select "Fighting" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Fighting%' group by board_category)as a union
select "Game System" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Game System%' group by board_category)as a union
select "Horror" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Horror%' group by board_category)as a union
select "Humor" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Humor%' group by board_category)as a union
select "Industry / Manufacturing" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Industry / Manufacturing%' group by board_category)as a union
select "Japon Brand" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Japon Brand%' group by board_category)as a union
select "Korean War" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Korean War%' group by board_category)as a union
select "Mafia" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Mafia%' group by board_category)as a union
select "Math" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Math%' group by board_category)as a union
select "Mature / Adult" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Mature / Adult%' group by board_category)as a union
select "Maze" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Maze%' group by board_category)as a union
select "Medical" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Medical%' group by board_category)as a union
select "Medieval" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Medieval%' group by board_category)as a union
select "Memory" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Memory%' group by board_category)as a union
select "Miniatures" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Miniatures%' group by board_category)as a union
select "Modern Warfare" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Modern Warfare%' group by board_category)as a union
select "Movies / TV / Radio theme" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Movies / TV / Radio theme%' group by board_category)as a union
select "Murder/Mystery" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Murder/Mystery%' group by board_category)as a union
select "Music" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Music%' group by board_category)as a union
select "Mythology" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Mythology%' group by board_category)as a union
select "Napoleonic" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Napoleonic%' group by board_category)as a union
select "Nate Hayden" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Nate Hayden%' group by board_category)as a union
select "Nautical" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Nautical%' group by board_category)as a union
select "Negotiation" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Negotiation%' group by board_category)as a union
select "Novel-based" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Novel-based%' group by board_category)as a union
select "Number" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Number%' group by board_category)as a union
select "Party Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Party Game%' group by board_category)as a union
select "Pike and Shot" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Pike and Shot%' group by board_category)as a union
select "Pirates" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Pirates%' group by board_category)as a union
select "Political" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Political%' group by board_category)as a union
select "Post-Napoleonic" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Post-Napoleonic%' group by board_category)as a union
select "Prehistoric" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Prehistoric%' group by board_category)as a union
select "Print & Play" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Print & Play%' group by board_category)as a union
select "Puzzle" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Puzzle%' group by board_category)as a union
select "Racing" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Racing%' group by board_category)as a union
select "Real-time" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Real-time%' group by board_category)as a union
select "Religious" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Religious%' group by board_category)as a union
select "Renaissance" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Renaissance%' group by board_category)as a union
select "Science Fiction" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Science Fiction%' group by board_category)as a union
select "Space Exploration" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Space Exploration%' group by board_category)as a union
select "Spies/Secret Agents" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Spies/Secret Agents%' group by board_category)as a union
select "Sports" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Sports%' group by board_category)as a union
select "Territory Building" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Territory Building%' group by board_category)as a union
select "Trains" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Trains%' group by board_category)as a union
select "Transportation" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Transportation%' group by board_category)as a union
select "Travel" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Travel%' group by board_category)as a union
select "Trivia" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Trivia%' group by board_category)as a union
select "Video Game Theme" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Video Game Theme%' group by board_category)as a union
select "Vietnam War" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Vietnam War%' group by board_category)as a union
select "Wargame" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Wargame%' group by board_category)as a union
select "Word Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Word Game%' group by board_category)as a union
select "World War I" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%World War I%' group by board_category)as a union
select "World War II" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%World War II%' group by board_category)as a union
select "Zombies" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating*ur.rating_players) end as score, case when ur.rating_players is NULL then info.rating_player else info.rating_player+ur.rating_players end as player from info left join user_rating as ur on info.id=ur.id where board_category like '%Zombies%' group by board_category)as a;

result:
board_category     sum(a.score)/sum(a.player)
-----------------  --------------------------
Abstract Strategy  6.78711883455731          
Action / Dexterit  6.47872222673789          
Adventure          7.24737357351629          
Age of Reason      7.21395573363501          
American Civil Wa  7.03631911328329          
American Indian W  7.44399800163058          
American Revoluti  7.38852344159627          
American West      6.91298591588734          
Ancient            7.30401838777187          
Animals            6.98895729796851          
Arabian            7.19576122570071          
Aviation / Flight  6.86710077587894          
Bluffing           7.11444241256691          
Book               6.20614678122296          
Card Game          7.00892640666213          
Children's Game    5.95055084295169          
City Building      7.25329742796046          
Civil War          7.23513571634942          
Civilization       7.55716599866147          
Collectible Compo  7.2968910203502           
Comic Book / Stri  5.66011972210355          
Deduction          7.01145625215378          
Dice               7.10755973666512          
Economic           7.48659483929407          
Educational        6.59864849450256          
Electronic         6.93521726597881          
Environmental      7.22578686294515          
Expansion for Bas  7.48227787161247          
Exploration        7.26499648838992          
Fan Expansion      7.11215355080214          
Fantasy            7.27057877057391          
Farming            7.53261628682094          
Fighting           7.29420569289954          
Game System        6.28284175157356          
Horror             7.19520286472224          
Humor              6.66018817535651          
Industry / Manufa  7.3813625564618           
Japon Brand        0                          
Korean War         6.19831777570093          
Mafia              6.62634225505923          
Math               5.91158980231543          
Mature / Adult     7.64394743222686          
Maze               6.64994363116946          
Medical            7.23691832397135          
Medieval           7.29808331621525          
Memory             5.95400364078717          
Miniatures         7.45291562136251          
Modern Warfare     6.82688680407967          
Movies / TV / Rad  6.60471361188103          
Murder/Mystery     6.74534341971579          
Music              5.61577741015109          
Mythology          7.45631433377649          
Napoleonic         7.16875096374473          
Nate Hayden        5.56155                   
Nautical           7.21156088585515          
Negotiation        7.17527318601398          
Novel-based        7.2919432297465           
Number             5.51803368610869          
Party Game         6.79898772532658          
Pike and Shot      7.19216628536659          
Pirates            6.91755553355789          
Political          7.20441458680468          
Post-Napoleonic    7.25087709111965          
Prehistoric        7.08728375032855          
Print & Play       6.74323666518976          
Puzzle             6.82431085603554          
Racing             6.5354116547183           
Real-time          6.8026647484824           
Religious          7.15433992844209          
Renaissance        7.32160198905134          
Science Fiction    7.36481427775389          
Space Exploration  7.49736908171761          
Spies/Secret Agen  7.34362589939429          
Sports             6.78415988506846          
Territory Buildin  7.43046757912808          
Trains             7.32348125767385          
Transportation     7.08691393400341          
Travel             6.67724144975116          
Trivia             5.6478751194085           
Video Game Theme   7.03451255178717          
Vietnam War        7.56901569731082          
Wargame            7.23420633914006          
Word Game          6.08946432157719          
World War I        7.06092095378679          
World War II       7.09569241051358          
Zombies            7.13163616365536  