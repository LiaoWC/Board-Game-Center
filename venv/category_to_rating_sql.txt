select "Card Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Card Game%' group by board_category)as a union
select "Wargame" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Wargame%' group by board_category)as a union
select "Children's Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like "%Children's Game%" group by board_category)as a union
select "Dice" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Dice%' group by board_category)as a union
select "Fantasy" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Fantasy%' group by board_category)as a union
select "Abstract Strategy" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Abstract Strategy%' group by board_category)as a union
select "Miniatures" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Miniatures%' group by board_category)as a union
select "Educational" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Educational%' group by board_category)as a union
select "Party Game" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Party Game%' group by board_category)as a union
select "Science Fiction" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Science Fiction%' group by board_category)as a union
select "Fighting" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Fighting%' group by board_category)as a union
select "Trivia" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Trivia%' group by board_category)as a union
select "Economic" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Economic%' group by board_category)as a union
select "Movies / TV / Radio theme" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Movies / TV / Radio theme%' group by board_category)as a union
select "Print & Play" as board_category, sum(a.score)/sum(a.player) from (select case when ur.rating is NULL then info.rating*info.rating_player else (info.rating*info.rating_player)+(ur.rating) end as score, case when ur.rating_player is NULL then info.rating_player else info.rating_player+ur.rating_player end as player from info left join (select game_id as id, sum(rating) as rating, count(rating) as rating_player from user_rating group by game_id)as ur on info.id=ur.id where board_category like '%Print & Play%' group by board_category)as a limit 15;
